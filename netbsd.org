#+PROPERTY: header-args :cache yes
#+PROPERTY: header-args+ :mkdirp yes
#+PROPERTY: header-args+ :results silent
#+PROPERTY: header-args+ :padline no
* WSCONS
** CONFIGURATION

#+BEGIN_SRC conf
#	$NetBSD: wscons.conf,v 1.22 2022/08/29 15:39:19 uwe Exp $
#
# workstation console configuration

# fonts to load
#	name	width	height	enc	file
#font	ibm	-	8	ibm	/usr/share/wscons/fonts/vt220l.808

# Note: "pcvt" encoded fonts are only useful with the "*bf" screen types
#  of the "vga" driver. The kernel must be compiled with the option
#  "WSCONS_SUPPORT_PCVTFONTS" turned on. See vga(4).
#font	pcvt	-	-	pcvt	/usr/share/wscons/fonts/vt220h.816
#font	pcvt	-	8	pcvt	/usr/share/wscons/fonts/vt220h.808

# Font for central european languages (ISO 8859-2).
#  Uncomment to load. Needs to be explicitly enabled (see below).
#font	latin2	-	16	iso	/usr/share/wscons/fonts/latin2.816

# Terminus at different sizes (the wsf files carry all the necessary
# information but rc.d/wscons wants the name to be specified).
font	Terminus16B-ISO8859-1	- - -	/usr/share/wscons/fonts/ter-116b.wsf
font	Terminus20-ISO8859-1	- - -	/usr/share/wscons/fonts/ter-120n.wsf
font	Terminus24-ISO8859-1	- - -	/usr/share/wscons/fonts/ter-124n.wsf
font	Terminus28-ISO8859-1	- - -	/usr/share/wscons/fonts/ter-128n.wsf
font	Terminus32-ISO8859-1	- - -	/usr/share/wscons/fonts/ter-132n.wsf

# screens to create
#	idx	screen	emul
# Screen 0 is already configured as console in most cases.
#  Uncomment if a serial console is used.
#screen	0	-	vt100
screen	1	-	vt100
screen	2	-	vt100
screen	3	-	vt100
screen	4	-	-
#screen	4	80x25bf	vt100
# Note: You must uncomment the 'font	ibm' line above to get a useful
#	font for any 50 line screens.
#screen	5	80x50	vt100

#keyboard	auto

# Select a kernel builtin keyboard map by uncommenting the following line and
# altering the country code to your requirements.
# See wskbd(4) for a full list of supported options.
encoding us.metaesc.apple

# Redefine individual keys from a file containing "keysym" and/or "keycode"
# entries.
# See wsconsctl(8) and /usr/share/wscons/keymaps for more details.
mapfile /usr/share/wscons/keymaps/apple.jp.emacs

# Set arbitrary wscons variable using specified control device
#	ctldev	var		value
# Use Terminus (see above for available sizes)
setvar	ttyE0	font		Terminus16B-ISO8859-1
setvar	ttyE1	font		Terminus20-ISO8859-1
setvar	ttyE2	font		Terminus20-ISO8859-1
setvar	ttyE3	font		Terminus20-ISO8859-1
# Change keyboard repeat speed to faster settings.
setvar	wskbd	repeat.del1	200
setvar	wskbd	repeat.deln	50
#+END_SRC

** MAPS

Dump current keymap with =wsconsctl map= and then experiment with:

~wsconsctl -map+="keycode $int $keysym"~

*** MBA JP EMACS

#+BEGIN_SRC conf
  # Emacs optimised layer for Japanese Macbook Air 6,1
  #
  # Escape
  keycode 41  = Caps_Lock
  # Caps Lock (bottom left of keyboard)
  keycode 57  = Cmd Meta_L
  # Control (usual Caps Lock location)
  keycode 224 = Cmd_Debugger Escape
  # Command keys
  keycode 227 = Cmd2 Alt_L
  keycode 231 = Cmd2 Alt_L
  # KANU (Right of Space)
  keycode 144 = Cmd1 Control_R
  # EISU (Left of Space)
  keycode 145 = Cmd1 Control_L
  # Dead key to the left of right Shift key
  keycode 135 = grave asciitilde
  # Dead key to the left of BackSpace
  keycode 137 = BackSpace
#+END_SRC

* XORG
** XDEFAULTS
#+NAME: Xdefaults
#+BEGIN_SRC conf :tangle ~/.Xdefaults
  XClock*analog: false
  XClock*reverseVideo: true
  XClock*foreground: white
  XClock*strftime: %H:%M %Y/%m/%d

  XLock.dpmsstandby: 1
  XLock.dpmssuspend: 2
  XLock.dpmsoff: 3
  XLock.mode: blank
  XLock.program: /usr/games/fortune -os
  XLock.startCmd: /home/toby/bin/zzzdelay

  Xft.dpi: 96
  Xft.antialias: true
  Xft.rgba: rgb
  Xft.hinting: true
  Xft.hintstyle: hintslight
  Xft.autohint: false
  Xft.lcdfilter: lcddefault

  XTerm*utf8: 1
  XTerm*BorderWidth: 0
  XTerm*faceName: Monospace: size=9
  XTerm*allowBoldFonts: false
  XTerm*backarrowKeyIsErase: true
  XTerm*fullscreen: never
  XTerm*locale: true
  XTerm*loginShell: true
  XTerm*metaSendsEscape: true
  XTerm*reverseVideo: on
  XTerm*scrollBar: off
  XTerm*selectToClipboard: true
  XTerm*termName: xterm-256color
  XTerm*ttyModes: erase^? kill ^U
#+END_SRC
#+BEGIN_SRC conf :noweb yes :tangle ~/.Xresources
<<Xdefaults>>
#+END_SRC
** XMODMAP
#+BEGIN_SRC conf :tangle ~/.xmodmap/space_cadet.kbd
  ! Clear all the modifiers
  clear control
  clear mod1
  clear mod4
  clear mod5
  clear lock

  ! Alt_R -> Control_L
  keycode 64 = Control_L

  ! ISO_Level3_Shift -> Control_R
  keycode 113 = Control_R

  ! Super_L -> Alt_L
  keycode 115 = Alt_L Meta_L

  ! PrtSc -> Alt_R
  ! keycode 111 = Alt_R Meta_R

  ! Menu  -> Alt_R
  keycode 117 = Alt_R Meta_R

  ! Control_L -> Super_L
  keycode 37 = Super_L

  ! Control_R -> Super_R
  keycode 109 = Super_R

  ! Escape -> Caps_Lock
  keycode 9 = Caps_Lock

  ! Caps_Lock -> Escape
  keycode 66 = Escape

  ! ThinkPad Fn -> Menu
  keysym XF86WakeUp = Menu

  ! Re-add modifiers
  add lock = Caps_Lock
  add Control = Control_L Control_R
  add mod1 = Alt_L Alt_R Meta_L Meta_R
  add mod4 = Super_L Super_R
  add mod5 = ISO_Level3_Shift
#+END_SRC
#+BEGIN_SRC conf :tangle ~/.xmodmap/ctrl_alt.kbd
  ! Clear all the modifiers
  clear control
  clear mod1
  clear mod4
  clear mod5
  clear lock

  ! ISO_Level3_Shift -> Control_R
  keycode 113 = Alt_R Meta_R

  ! Super_L -> Control_L
  keycode 115 = Control_L

  ! PrtSc -> Control_R
  keycode 111 = Control_R

  ! Escape -> Caps_Lock
  keycode 9 = Caps_Lock

  ! Caps_Lock -> Escape
  keycode 66 = Escape

  ! ThinkPad Fn -> Menu
  keysym XF86WakeUp = Menu

  ! Re-add modifiers
  add lock = Caps_Lock
  add Control = Control_L Control_R
  add mod1 = Alt_L Alt_R Meta_L Meta_R
  add mod4 = Super_L Super_R
  add mod5 = ISO_Level3_Shift
#+END_SRC
** XSESSION
#+NAME: xsession
#+BEGIN_SRC conf :tangle ~/.xsession
  setxkbmap gb
  xmodmap ~/.xmodmap/space_cadet.kbd
  xrdb ~/.Xdefaults
  #xsetwallpaper ~/etc/netbsd/img/bg/loadingz-wallpaper.jpg
  xbattbar top &
  exec jwm
#+END_SRC
#+BEGIN_SRC conf :noweb yes :tangle ~/.xinitrc
  <<xsession>>
#+END_SRC
